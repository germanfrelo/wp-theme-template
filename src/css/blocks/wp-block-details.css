/* ======================================================================
WP BLOCK DETAILS
---
Source:
https://github.com/WordPress/gutenberg/tree/trunk/packages/block-library/src/details
---
Notes:
- To customize most of this block and its parts, use the custom properties.
---
Resources:
- https://developer.mozilla.org/en-US/docs/Web/HTML/Element/summary#changing_the_summarys_icon
- https://www.scottohara.me/blog/2022/09/12/details-summary.html
- https://nerdy.dev/notebook/accordion.html
- https://developer.chrome.com/blog/styling-details
====================================================================== */

.wp-block-details {
	padding-block-start: var(--details-padding-top);
	padding-block-end: var(--details-padding-bottom);
	padding-inline-start: var(--details-padding-left);
	padding-inline-end: var(--details-padding-right);
	background-color: var(--details-background-color);
	border-color: var(--details-border-color);
	border-style: var(--details-border-style);
	border-width: var(--details-border-width);
	border-radius: var(--details-border-radius);

	@media (prefers-reduced-motion: no-preference) {
		interpolate-size: allow-keywords;
	}

	> summary {
		display: flex;
		flex-wrap: wrap;
		gap: var(--details-summary-gap, 1ch);
		align-items: center;
		justify-content: space-between;
		font-family: var(--details-summary-font-family);
		font-size: var(--details-summary-font-size);
		font-weight: var(--details-summary-font-weight);
		line-height: var(--details-summary-line-height);
		color: var(--details-summary-text-color);
		letter-spacing: var(--details-summary-letter-spacing);
		cursor: var(--details-summary-cursor, default);
		list-style: none;

		@media (prefers-reduced-motion: no-preference) {
			transition-duration: var(--transition-duration);
			transition-property: color, background-color, border-color, border-radius;
		}

		&:hover {
			background-color: var(--details-summary-background-color-hover, var(--details-background-color));
		}
	}

	/*
	Custom Icon.
	It's rendered after the summary by default. To render it before, just change '::after' to '::before'.
	---------------------------------------------------------------------- */

	/* Remove the default icon in WebKit-based browsers. */
	> summary::-webkit-details-marker {
		display: none;
	}

	/*
	Add a custom marker.
	*/
	> summary::after {
		display: inline-block;
		flex-shrink: 0;
		inline-size: var(--details-icon-size, 2.5rem);
		block-size: var(--details-icon-size, 2.5rem);
		content: "";
		background-color: var(--details-icon-color, currentcolor);
		mask-image: var(--details-icon-image, none);
		mask-position: center;
		mask-size: cover;
	}

	/* ⚠️ Do NOT add any margin here; add it to the element(s) inside the details content. */
	&::details-content {
		block-size: 0;
		padding-block-start: var(--details-content-padding-top, 0);
		padding-block-end: var(--details-content-padding-bottom, 0);
		/* display: grid; */
		margin-block: 0 !important; /* If there is some margin, the open/close transition is a bit clumsy */ /* TODO: Double check this */
		overflow-block: clip;
		font-size: var(--details-content-font-size);
		opacity: 0;

		@media (prefers-reduced-motion: no-preference) {
			transition:
				content-visibility var(--transition-duration, 0) allow-discrete,
				opacity var(--transition-duration, 0),
				block-size var(--transition-duration, 0),
				border-radius var(--transition-duration, 0);
		}

		& > * {
			margin-block: 0 !important; /* If there is some margin, the open/close transition is a bit clumsy */ /* TODO: Double check this */
		}
	}

	&[open] {
		border-start-start-radius: 0;
		border-start-end-radius: 0;

		/* Change marker when details is open */
		> summary::after {
			background-color: var(--details-icon-color-hover, var(--details-icon-color, currentcolor));
			mask-image: var(--details-open-icon-image, none);
		}

		&::details-content {
			block-size: auto;
			opacity: 1;
		}
	}
}
